<div itemid="{{ product.id }}" class="product{{ product.has_other_prices ? ' has-other-prices' }}" {{ product.data_tray_ga4 }}>
    <a href="{{ product.link }}" data-tray-tst="vitrine_produto_link_imagem">

        <div class="product-image">
            {% if product.images %}
                {% if utils.is_mobile %}
                    <img itemprop="image" src="{{ product.images[0].large }}" alt="{{ product.name }}" title="{{ product.name }}" loading="lazy">
                {% else %}
                    <img itemprop="image" data-original="{{ product.images[0].large }}" class="lazy" src="{{ asset('img/loading.svg') }}" alt="{{ product.name }}" title="{{ product.name }}" loading="lazy">
                {% endif %}
            {% else %}
                <img src="{{ asset('img/no-image.svg') }}" alt="Nenhuma imagem foi cadastrada para {{ product.name }}" width="100" title="{{ product.name }}" loading="lazy">
            {% endif %}
            
            {% if settings.discount %}
                {% set porcentagemDesconto = 100 - ( product.price_offer / product.price ) * 100 %}
                {% if porcentagemDesconto < 100 %}
                  <span class="discount"> {{ porcentagemDesconto|number_format }}% de desconto </span>
                {% endif %}  
            {% endif %}             
        </div>
    
        <h3 class="product-name" itemprop="name">{{ product.name }}</h3>

        <meta itemprop="productID" content="{{ product.id }}"/>
        <meta itemprop="sku" content="{{ product.id }}"/>

        {% if product.ean %}
            <meta itemprop="gtin14" content="{{ product.ean }}">
        {% endif %}
        
        {% if product.description_small %}
            <meta itemprop="description" content="{{ product.description_small }}">
        {% endif %}
        
        {% if product.brand %}
        <span itemprop="brand" itemscope itemtype="http://schema.org/Organization">
            <meta itemprop="name" content="{{ product.brand }}"/>
        </span>
        {% endif %} 

        {% for discount in product.ProgressiveDiscounts %}
            {% if discount.tag %}
                <div class="product-discount-recursive-tag">{{discount.tag}}</div>
                <div class="product-discount-recursive-desc">{{discount.description}}</div>
            {% endif %}
        {% endfor %} 
    
        {% if settings.cache_infopreco %}
            <div data-module="pricing" data-snippet="snippets/product-payment" data-product-id="{{ product.id }}">
                <div class="pricing">
                    Carregando...
                </div>
            </div>
        {% else %}
            {% element 'snippets/product-payment' {"product": product } %}
        {% endif %}
        
    </a>
    
    {% if (product.stock > 0 or settings.without_stock_sale) > 0 and product.available %}
        {% if not product.has_variation %}
            {% if (settings.buy_to_cart) and (not product.is_kit) and (not product.upon_request) %}
                <button class="product-seemore" onclick="addCart({{ product.id }})" aria-label="Comprar {{ product.name }}">
                    Comprar
                </button>    
            {% else %}
                <a href="{{ product.link }}" class="product-seemore" aria-label="Ver mais detalhes de {{ product.name }}">
                    Ver mais
                </a>    
            {% endif %}
        {% else %}
            <a href="{{ product.link }}" class="product-seemore" aria-label="Ver mais detalhes de {{ product.name }}">
                Ver mais
            </a>   
        {% endif %}
    {% endif %}  

    {% if pages.current == 'catalog' and settings.compare %}
    <div class="compare-buttons">
        {% set compareCSS = 'compare-hidden' %}

        <a data-compare="remove" href="{{ links.compare_delete ~ product.id }}" class="{{ not product.compare ? compareCSS }}" aria-label="Remover {{ product.name }} da comparação">
            <span class="filter-checkbox checked"></span>
            {{ Translation("remover_comparar") }}
        </a>
        
        <a data-compare="add" href="{{ links.compare_add  ~ product.id }}" class="{{ product.compare ? compareCSS }}" aria-label="Adicionar {{ product.name }} à comparação">
            <span class="filter-checkbox"></span>
            {{ Translation("comparar_produto") }}
        </a>
    </div>
    {% endif %}
</div>